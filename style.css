:root{
  --bg:#ffffff; --fg:#0b1220; --muted:#6b7280; --accent:#5b7cff;
  --panel:#f5f7fb; --line:#e6e8ee; --panel-2:#eef1f7;
}
body.dark{ --bg:#0c0f14; --fg:#e6e9ef; --muted:#9aa3b2; --panel:#121720; --line:#1e2633; --panel-2:#0f141d; --accent:#7aa2ff; }
*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0; font-family:Inter, system-ui, sans-serif; background:var(--bg); color:var(--fg);
}
.topbar{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 16px; border-bottom:1px solid var(--line); background:var(--panel);
  position:sticky; top:0; z-index:5;
}
.filename{
  font-size:16px; font-weight:600; border:none; background:transparent; color:var(--fg); padding:6px 8px; border-radius:8px;
}
.filename:focus{ outline:2px solid var(--accent); background:var(--panel-2); }
.meta{ margin-left:10px; color:var(--muted); font-size:12px; }
.topbar .right button{ margin-left:8px; }
button, select, input{ background:var(--panel-2); color:var(--fg); border:1px solid var(--line); border-radius:10px; padding:8px 10px; cursor:pointer; }
button:hover, select:hover{ filter:brightness(1.05); }
button.accent{ background:var(--accent); color:#fff; border-color:transparent; }
.ribbon{
  display:flex; gap:8px; flex-wrap:wrap; padding:8px 12px; border-bottom:1px solid var(--line); background:var(--panel);
  position:sticky; top:52px; z-index:4;
}
.file-btn{ display:inline-flex; align-items:center; gap:6px; }
.workspace{ display:flex; height:calc(100vh - 140px); }
.history{
  width:220px; border-right:1px solid var(--line); background:var(--panel); padding:10px; overflow:auto;
}
.history-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:10px; }
#topics{ list-style:none; padding:0; margin:0; }
#topics li{ padding:8px; border:1px solid var(--line); border-radius:8px; margin-bottom:8px; background:var(--bg); cursor:pointer; }
#topics li:hover{ border-color:var(--accent); }

.sheet-wrap{ position:relative; flex:1; overflow:auto; padding:24px; background:
  radial-gradient(1500px 500px at 50% -200px, rgba(91,124,255,0.08), transparent 60%) }
.sheet{
  width:900px; max-width:100%; min-height:1200px; margin:0 auto; padding:64px 72px; background:var(--bg);
  border:1px solid var(--line); border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.06);
}
.sheet:focus{ outline:none; }

.draw-layer{
  display:none; position:absolute; inset:24px; left:50%; transform:translateX(-50%);
  width:900px; max-width:calc(100% - 48px); height:1200px; border:1px dashed var(--line); border-radius:16px; background:transparent; cursor:crosshair;
}
.draw-layer.active{ display:block; }

.ai{
  width:360px; border-left:1px solid var(--line); background:var(--panel); height:100%; display:flex; flex-direction:column;
  transition:transform .25s ease; transform:translateX(0);
}
.ai.closed{ transform:translateX(360px); }
.ai-head{ display:flex; justify-content:space-between; align-items:center; padding:10px; border-bottom:1px solid var(--line); }
.ai-controls{ display:flex; gap:8px; padding:10px; }
.ai textarea{ margin:0 10px; height:120px; resize:vertical; }
.ai-output{ margin:10px; padding:10px; background:var(--bg); border:1px solid var(--line); border-radius:10px; min-height:120px; white-space:pre-wrap; }
.ai-actions{ display:flex; flex-wrap:wrap; gap:8px; padding:10px; }

.footer{
  padding:8px 16px; border-top:1px solid var(--line); color:var(--muted); background:var(--panel); display:flex; justify-content:center;
}
